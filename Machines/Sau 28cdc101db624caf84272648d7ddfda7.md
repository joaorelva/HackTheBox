# Sau

![Untitled](Sau%2028cdc101db624caf84272648d7ddfda7/Untitled.png)

## Enumeration

nmap -A -sV -sS <target_ip>

![Untitled](Sau%2028cdc101db624caf84272648d7ddfda7/Untitled%201.png)

Port 55555 is running a “request baskets” service. Request baskets is a web service to collect arbitrary HTTP requests and inspect them via RESTful API or simple web UI. We can see that the service running is in 1.2.1 version.

![Untitled](Sau%2028cdc101db624caf84272648d7ddfda7/Untitled%202.png)

![Untitled](Sau%2028cdc101db624caf84272648d7ddfda7/Untitled%203.png)

## Exploitation

After some research i found that this version have one vulnerability that can be exploitable (CVE-2023-27163). Request baskets service is vulnerable to a SSRF attack as we can see in the below proof of concept:

[https://github.com/entr0pie/CVE-2023-27163#poc-of-ssrf-on-request-baskets-cve-2023-27163](https://github.com/entr0pie/CVE-2023-27163#poc-of-ssrf-on-request-baskets-cve-2023-27163)

Essentially, when we have a SSRF vulnerability, a vulnerable server can make request to other internal services on behalf of the attacker.

![Untitled](Sau%2028cdc101db624caf84272648d7ddfda7/Untitled%204.png)

As we can saw in the enumeration step, this machine have a service running in port 80. So i created a basket to make a request to the port 80 of the target. And i had success.

After that i saw that is running Maltrail v0.53. It’s a vulnerable version and we can found the exploit in [https://github.com/spookier/Maltrail-v0.53-Exploit#usage](https://github.com/spookier/Maltrail-v0.53-Exploit#usage).

![Untitled](Sau%2028cdc101db624caf84272648d7ddfda7/Untitled%205.png)

![Untitled](Sau%2028cdc101db624caf84272648d7ddfda7/Untitled%206.png)

![Untitled](Sau%2028cdc101db624caf84272648d7ddfda7/Untitled%207.png)

User flag found in the “puma” user directory.

## Privilege Escalation

sudo -l to see what commands can the user run as root

![Untitled](Sau%2028cdc101db624caf84272648d7ddfda7/Untitled%208.png)

If we can execute systemctl status as root, we can spawn another shell in the pager with root privileges:

[https://gtfobins.github.io/gtfobins/systemctl/](https://gtfobins.github.io/gtfobins/systemctl/)

![Untitled](Sau%2028cdc101db624caf84272648d7ddfda7/Untitled%209.png)

Root flag found in root directory.